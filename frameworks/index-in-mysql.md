# MySql索引

Q：为什么mysql索引用b+tree，而不用二叉树/红黑树 二叉树：

A：极端情况下单边增长。二叉平衡树包含红黑树，红黑树——数据量大时，树的层次会很深\(深度为n的红黑树保存的数据量为2^n\)，红黑树的深度不可控！   
红黑树 -&gt; BTree：二叉树增加横向扩展，即多叉平衡树

### BTree介绍 

度：节点中存储的数据的个数 叶结点具有相同的深度 叶结点指针为空\(节点的左右子树为空\) 叶结点的key从左向右递增

### B+ tree介绍 

非叶子节点只存储key，不存value。  
叶子节点不存储指针 

顺序访问指针：提高区间/范围访问性能 

非叶子节点冗余关键key, data保存到叶子节点的原因：空间换时间，为了一次io读取到更多的key。  
 索引节点的大小默认为16k, 能存储的数据量是有限制的。只保存key可以在一个节点中保存更多的key, 也就是增大节点的度。

 Cpu读磁盘数据，每次读页的整数倍。1页一般是4k。

为什么mysql索引节点的默认大小为16k？  
mysql文件页大小为16k, 每次新建索引节点可以直接申请一个页。mysql整型\(推荐建立索引的数据类型\)为8个字节，指针为6个字节，一个索引节点可以保存1170个记录， B+树高度一般为1到3，最高可以到5。  
为什么MySQL建议把索引建在整型自增字段上？  
创建B+树（即索引）时比较方便。

数据库查询耗时间主要是磁盘io， Mysql提供btree和索引两种方式，为什么常用btree? Mysql存储引擎\(？\)形容数据库表的存储结构

MyIsam存储引擎 数据表的存储：.frm文件 保存表结构，.myd文件保存数据，.myi文件保存索引\(其中保存一个b+tree, b+树上，节点key为建索引的一段，value为对应记录在磁盘上的位置\)。

### Innodb存储引擎

 数据表的存储：

* .frm文件保存表结构
* .ibd文件保存索引＋数据。

 为什么索引和数据保存在一起？  
文件中的数据按b+树存储，即value中保存数据，不存位置。

聚集索引：叶节点中包含完整的数据记录。

主键索引：根据主键建立的索引 ，

二级索引即非主键索引。 

Innodb的二级索引中的value保存的是主键。 为什么innodb表必须有主键，且建议主键为整型的自增主键？  
整型见冗余数据，自增为了提高插入数据的速率，因为b+中的数据按顺序排列。若没有合适的索引，innodb会默认添加一个整型索引。 

不要用uuid作为主键，原因：uuid是字符串类型，占磁盘空间，降低一个索引节点能够保存的记录

联合索引的存储结构？索引优化？

### 使用B+做索引的优点



